# Required TOSCA Definitions version string
tosca_definitions_version: tosca_simple_yaml_1_0

# Optional. default namespace (schema, types version)
tosca_default_namespace: http://types.opentosca.org

# Optional name of this service template
template_name: Moodle

# Optional author of this service template
template_author:

# Optional version of this service template
template_version:

description: Service Template for Moodle

imports:
  # list of import statements for importing other definitions files
  - MoodleTypes-Definitions.yml
  - TOSCA-v1.0-SpecificTypes-Definitions.yml
  - TOSCA_definition.yml
  
topology_template:
  node_templates:
    VmApache:
      type: tosca.nodes.Compute
      properties:
        num_cpus: 1
        mem_size: 1024
      capabilities:
        VmApache_os: #TODO: Define Capability Type
          type: OperatingSystemContainerCapability
      requirements:
        - VmApache_networks:
        - VmApache_container:
        - VmApache_volumes:
        
    OsApache:
      type: OperatingSystem
      capabilities:
        OsApache_software: #TODO: Define Capability Type
          type: SoftwareContainerCapability
      requirements:
        - host: VmApache_os
    
    ApacheWebServer:
      type: ApacheWebServer
      properties:
        httpdport: 80
      capabilities: #TODO: Define Capability Type
        ApacheWebServer_webapps:
          type: ApacheWebApplicationContainerCapability
        ApacheWebServer_modules:
          type: ApacheModuleContainerCapability
        ApacheWebServer_clients:
          type: HTTPEndpointCapability
      requirements:
        - host: OsApache_software
    
    MoodleApp:
      type: MoodleApplication
      properties:
        AdminUser: admin
        AdminPassword: moodle123
        SiteName: My Moodle
        SitePath: mymoodle
      requirements:
        - host: ApacheWebServer_webapps
        - dependsOn: PhpModule_phpapps
        - connectsTo: MoodleDb_clients
        
    PhpModule:
      type: ApachePHPModule
      capabilities:
        PhpModule_phpapps: #TODO: Define Capability Type
          type: PHPRuntimeCapability
      requirements:
        - host: ApacheWebServer_modules
      
    MySql:
      type: MySQL
      properties:
        RootPassword: password
      capabilities:
        MySql_database: #TODO: Define Capability Type
          type: MySQLDatabaseContainerCapability
      requirements:
        - host: OsApache_software
    
    MoodleDb:
      type: MoodleDatabase
      properties:
        DBName: moodledb
        DBUser: mdladmin
        DBPassword: mdladmin
        DBPort: 3306
      capabilities:
        MoodleDb_clients:
          type: MySQLDatabaseEndpoint
      requirements:
        - host: MySql_database
        
    
      
    